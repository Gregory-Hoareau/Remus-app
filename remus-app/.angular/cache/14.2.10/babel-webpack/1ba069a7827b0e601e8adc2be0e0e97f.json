{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/antho/OneDrive/Documents/GitHub/Remus-app/remus-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { ModalController, AlertController } from '@ionic/angular';\nimport { CharacterSheet } from 'src/app/models/character-sheet.model';\nimport { Trait } from 'src/app/models/trait.model';\nimport { CharacterService } from 'src/app/providers/character/character.service';\nimport { Router } from '@angular/router';\nimport { CrowdsourcingService } from 'src/app/providers/crowdsourcing/crowdsourcing.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ionic/angular\";\nimport * as i2 from \"src/app/providers/character/character.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"src/app/providers/crowdsourcing/crowdsourcing.service\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/material/expansion\";\n\nfunction CustomSheetPage_ion_item_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\")(1, \"ion-label\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const data_r3 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(data_r3.name);\n  }\n}\n\nfunction CustomSheetPage_ion_item_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\")(1, \"ion-label\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const trait_r4 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(trait_r4.name);\n  }\n}\n\nfunction CustomSheetPage_ion_chip_28_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"ion-chip\", 19)(1, \"ion-icon\", 20);\n    i0.ɵɵlistener(\"click\", function CustomSheetPage_ion_chip_28_Template_ion_icon_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const tag_r5 = restoredCtx.$implicit;\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.removeTag(tag_r5));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(2, \"ion-label\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const tag_r5 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(tag_r5);\n  }\n}\n\nexport let CustomSheetPage = /*#__PURE__*/(() => {\n  class CustomSheetPage {\n    constructor(modalController, alertController, characterService, router, crowdsourcingService) {\n      this.modalController = modalController;\n      this.alertController = alertController;\n      this.characterService = characterService;\n      this.router = router;\n      this.crowdsourcingService = crowdsourcingService;\n      this.selectedTags = [];\n    }\n\n    ngOnInit() {}\n\n    closeModal() {\n      this.modalController.dismiss(undefined, 'cancel');\n    }\n\n    addPersonalData() {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        const alert = yield _this.alertController.create({\n          header: 'Ajout de données d\\'identité',\n          inputs: [{\n            name: 'data',\n            type: 'text',\n            placeholder: 'Nom'\n          }],\n          buttons: [{\n            text: 'Annuler',\n            role: 'cancel'\n          }, {\n            text: 'Ajouter',\n            handler: data => {\n              if (data.data) {\n                _this.sheet.other_personal.push(new Trait(data.data));\n              }\n            }\n          }]\n        });\n        alert.present();\n      })();\n    }\n\n    addTrait() {\n      var _this2 = this;\n\n      return _asyncToGenerator(function* () {\n        const alert = yield _this2.alertController.create({\n          header: 'Ajout de données d\\'identité',\n          inputs: [{\n            name: 'trait',\n            type: 'text',\n            placeholder: 'Nom de caractéristique'\n          }],\n          buttons: [{\n            text: 'Annuler',\n            role: 'cancel'\n          }, {\n            text: 'Ajouter',\n            handler: data => {\n              if (data.trait) {\n                _this2.sheet.traits.push(new Trait(data.trait));\n              }\n            }\n          }]\n        });\n        alert.present();\n      })();\n    }\n\n    createInputs() {\n      const res = [];\n      const tags = this.crowdsourcingService.getAvailableTags();\n\n      for (const tag of tags) {\n        console.log(tag);\n        res.push({\n          value: tag,\n          label: tag,\n          type: 'checkbox',\n          checked: this.selectedTags.includes(tag)\n        });\n      }\n\n      return res;\n    }\n\n    addTags() {\n      var _this3 = this;\n\n      return _asyncToGenerator(function* () {\n        _this3.tagInputs = _this3.createInputs();\n        const tagAlert = yield _this3.alertController.create({\n          header: 'Ajout de tag',\n          inputs: _this3.tagInputs,\n          buttons: [{\n            text: 'Annuler',\n            role: 'cancel'\n          }, {\n            text: 'Confirmer',\n            handler: data => {\n              if (data.length !== 0) {\n                _this3.selectedTags = data;\n              }\n            }\n          }]\n        });\n        tagAlert.present();\n      })();\n    }\n\n    removeTag(tag) {\n      const index = this.selectedTags.indexOf(tag);\n      this.selectedTags.splice(index, 1);\n    }\n\n    stringfySelectedTag() {\n      let res = '';\n\n      for (const tag of this.selectedTags) {\n        res += tag + ',';\n      }\n\n      return res;\n    }\n\n    finishCustomisation() {\n      this.sheet.tags = this.stringfySelectedTag();\n      this.characterService.setCustomSheet(this.sheet);\n      const extras = {\n        state: this.dataReturned\n      };\n      this.router.navigate(['sessionHome'], extras);\n      this.modalController.dismiss();\n    }\n\n    finishCustomisationAlert() {\n      var _this4 = this;\n\n      return _asyncToGenerator(function* () {\n        const alert = yield _this4.alertController.create({\n          header: 'Vous êtes sur le point sauvegarder votre feuille de personnage.',\n          subHeader: 'Une fois cela fait vous ne pourrez plus la modifier, êtes-vous sur de vouloir sauvegarder ?',\n          buttons: [{\n            text: 'Annuler',\n            role: 'cancel'\n          }, {\n            text: 'Sauvegarder',\n            handler: () => {\n              _this4.finishCustomisation();\n            }\n          }]\n        });\n        alert.present();\n      })();\n    }\n\n  }\n\n  CustomSheetPage.ɵfac = function CustomSheetPage_Factory(t) {\n    return new (t || CustomSheetPage)(i0.ɵɵdirectiveInject(i1.ModalController), i0.ɵɵdirectiveInject(i1.AlertController), i0.ɵɵdirectiveInject(i2.CharacterService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i4.CrowdsourcingService));\n  };\n\n  CustomSheetPage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CustomSheetPage,\n    selectors: [[\"app-custom-sheet\"]],\n    inputs: {\n      sheet: \"sheet\",\n      dataReturned: \"dataReturned\"\n    },\n    decls: 32,\n    vars: 5,\n    consts: [[3, \"translucent\"], [\"color\", \"header\"], [\"slot\", \"end\", 3, \"click\"], [\"name\", \"close-outline\", 1, \"ion-margin\"], [3, \"fullscreen\"], [\"multi\", \"true\"], [1, \"section\"], [1, \"section-title\"], [1, \"mes\"], [\"color\", \"btn-purple\", \"shape\", \"round\", 3, \"click\"], [\"name\", \"add\"], [1, \"personal\"], [4, \"ngFor\", \"ngForOf\"], [1, \"trait\"], [\"color\", \"btn-purple\", 3, \"click\"], [1, \"tags\"], [\"color\", \"dark\", \"mode\", \"ios\", 4, \"ngFor\", \"ngForOf\"], [\"vertical\", \"bottom\", \"horizontal\", \"end\", \"slot\", \"fixed\"], [\"name\", \"save\"], [\"color\", \"dark\", \"mode\", \"ios\"], [\"name\", \"close\", 3, \"click\"]],\n    template: function CustomSheetPage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-header\", 0)(1, \"ion-toolbar\", 1)(2, \"ion-buttons\", 2);\n        i0.ɵɵlistener(\"click\", function CustomSheetPage_Template_ion_buttons_click_2_listener() {\n          return ctx.closeModal();\n        });\n        i0.ɵɵelement(3, \"ion-icon\", 3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"ion-title\");\n        i0.ɵɵtext(5, \"custom-sheet\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(6, \"ion-content\", 4)(7, \"mat-accordion\", 5)(8, \"mat-expansion-panel\", 6)(9, \"mat-expansion-panel-header\", 7);\n        i0.ɵɵtext(10, \" Identit\\u00E9 \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"div\", 8);\n        i0.ɵɵtext(12, \" Par d\\u00E9faut, la fiche contient les champs suivant : nom, sexe, \\u00E2ge et background \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"ion-button\", 9);\n        i0.ɵɵlistener(\"click\", function CustomSheetPage_Template_ion_button_click_13_listener() {\n          return ctx.addPersonalData();\n        });\n        i0.ɵɵelement(14, \"ion-icon\", 10);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"ion-list\", 11);\n        i0.ɵɵtemplate(16, CustomSheetPage_ion_item_16_Template, 3, 1, \"ion-item\", 12);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(17, \"mat-expansion-panel\", 6)(18, \"mat-expansion-panel-header\", 7);\n        i0.ɵɵtext(19, \" Caract\\u00E9ristiques \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"ion-button\", 9);\n        i0.ɵɵlistener(\"click\", function CustomSheetPage_Template_ion_button_click_20_listener() {\n          return ctx.addTrait();\n        });\n        i0.ɵɵelement(21, \"ion-icon\", 10);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"ion-list\", 13);\n        i0.ɵɵtemplate(23, CustomSheetPage_ion_item_23_Template, 3, 1, \"ion-item\", 12);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(24, \"ion-button\", 14);\n        i0.ɵɵlistener(\"click\", function CustomSheetPage_Template_ion_button_click_24_listener() {\n          return ctx.addTags();\n        });\n        i0.ɵɵelement(25, \"ion-icon\", 10);\n        i0.ɵɵtext(26, \" tag \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(27, \"div\", 15);\n        i0.ɵɵtemplate(28, CustomSheetPage_ion_chip_28_Template, 4, 1, \"ion-chip\", 16);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(29, \"ion-fab\", 17)(30, \"ion-fab-button\", 14);\n        i0.ɵɵlistener(\"click\", function CustomSheetPage_Template_ion_fab_button_click_30_listener() {\n          return ctx.finishCustomisationAlert();\n        });\n        i0.ɵɵelement(31, \"ion-icon\", 18);\n        i0.ɵɵelementEnd()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"translucent\", true);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"fullscreen\", true);\n        i0.ɵɵadvance(10);\n        i0.ɵɵproperty(\"ngForOf\", ctx.sheet.other_personal);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngForOf\", ctx.sheet.traits);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngForOf\", ctx.selectedTags);\n      }\n    },\n    dependencies: [i5.NgForOf, i1.IonButton, i1.IonButtons, i1.IonChip, i1.IonContent, i1.IonFab, i1.IonFabButton, i1.IonHeader, i1.IonIcon, i1.IonItem, i1.IonLabel, i1.IonList, i1.IonTitle, i1.IonToolbar, i6.MatAccordion, i6.MatExpansionPanel, i6.MatExpansionPanelHeader],\n    styles: [\".mes[_ngcontent-%COMP%]{color:#0d3faa}.section-title[_ngcontent-%COMP%]{font-weight:700}\"]\n  });\n  return CustomSheetPage;\n})();","map":null,"metadata":{},"sourceType":"module"}